/* Mobile overrides for expense category picker and add-record modal */

/* --- Enforce 4-column grid on mobile and tighten card layout --- */
@media (max-width: 480px) {
  .expense-category-header {
    padding: 2px 10px 2px;
    min-height: 28px;
  }

  .preset-category-label {
    font-size: 14px;
  }

  .edit-category-btn {
    height: 30px;
    padding: 4px 6px;
  }

  #expenseCategoryPicker {
    /* bring grid closer to title */
    margin-top: -8px;
  }

  #expenseCategoryPicker .category-cards {
    grid-template-columns: repeat(4, minmax(0, 1fr)); /* 恢复为严格的4列布局 */
    gap: 8px;
    padding: 2px 6px;
    max-height: 240px; /* better vertical space */
  }

  #expenseCategoryPicker .category-card {
    width: 100%; /* fill grid cell */
    max-width: none;
    min-width: 0;
    aspect-ratio: 1 / 1;
    padding: 6px;
  }

  #expenseCategoryPicker .category-card__content {
    gap: 4px; /* tighter internals */
    padding: 10px 4px 4px; /* 增加顶部内边距，减少底部内边距 */
  }

  #expenseCategoryPicker .category-card .category-icon {
    width: 24px; /* 调整图标尺寸 */
    height: 24px;
    margin: 0 auto 2px; /* 添加底部边距 */
    border-radius: 7px; /* 减小圆角 */
    box-shadow: 0 2px 4px rgba(102, 126, 234, 0.25); /* 减小阴影效果 */
  }

  #expenseCategoryPicker .category-card .category-icon i {
    font-size: 0.75rem;
  }

  #expenseCategoryPicker .category-card .category-name {
    font-size: 12px;
    line-height: 1.2;
    margin: 0;
    white-space: normal; /* 允许内容换行 */
    word-break: normal; /* 正常断词 */
    overflow-wrap: break-word; /* 处理长单词 */
    text-align: center;
    width: 4.8em; /* 精确控制宽度以容纳4个字符，并在第5个字符时换行 */
    min-height: 2.4em; /* 预留两行空间以稳定布局 */
    display: flex; /* 使用flex进行垂直居中 */
    align-items: center;
    justify-content: center;
  }

  /* 针对不同字符长度的分类名称进行特殊处理 */
  #expenseCategoryPicker .category-card .category-name[data-length="1"],
  #expenseCategoryPicker .category-card .category-name[data-length="2"],
  #expenseCategoryPicker .category-card .category-name[data-length="3"],
  #expenseCategoryPicker .category-card .category-name[data-length="4"] {
    white-space: nowrap; /* 1-4个字符保持单行显示 */
    min-height: 1.2em; /* 单行高度即可 */
  }

  #expenseCategoryPicker .category-card .category-name[data-length="5"] {
    width: 4em; /* 限制宽度，使第5个字符换行 */
    min-height: 2.4em; /* 两行高度 */
    line-height: 1.2;
  }

  #expenseCategoryPicker .category-card .category-name[data-length="6"] {
    width: 3em; /* 限制宽度，实现3+3换行 */
    min-height: 2.4em; /* 两行高度 */
    line-height: 1.2;
  }

  /* Safari浏览器特殊处理 */
  @supports (-webkit-touch-callout: none) {
    #expenseCategoryPicker .category-card .category-name[data-length="5"],
    #expenseCategoryPicker .category-card .category-name[data-length="6"] {
      -webkit-line-break: after-white-space; /* Safari专用换行控制 */
      line-break: auto; /* 标准换行控制 */
    }
  }
}

/* --- Trim add-record modal top area on mobile --- */
@media (max-width: 480px) {
  #addRecordModal .modal-title {
    margin-bottom: 8px;
  }
}
